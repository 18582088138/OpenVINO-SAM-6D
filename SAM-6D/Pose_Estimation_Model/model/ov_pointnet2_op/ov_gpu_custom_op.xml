<CustomLayer name="BallQuery" type="SimpleGPU" version="1">
    <Kernel entry="ov_ball_query">
        <Source filename="ball_query.cl"/>
        <Define name="nsample" type="int"   param="nsample"/>
        <Define name="radius"  type="float" param="radius"/>
    </Kernel>
    <Buffers><!-- use the same order as the kernel entry function, so in this case (input0,input1,output0,int,float,weights) -->
        <Tensor arg-index="0" type="input" port-index="0" />   <!-- new_xyz (B, npoint, 3) --> 
        <Tensor arg-index="1" type="input" port-index="1" />                <!-- xyz (B, n, 3) -->                 
        <Tensor arg-index="2" type="output" port-index="0" format="BFYX"/>                <!-- idx (B, npoint, nsample) -->                 
        
    </Buffers>
    <CompilerOptions options="-cl-mad-enable"/>
    <WorkSizes global="B,F,1" local="1,64,1"/>
</CustomLayer>


<CustomLayer name="CustomDet" type="SimpleGPU" version="1">
    <Kernel entry="ov_custom_det">
        <Source filename="custom_det.cl"/>
    </Kernel>
    <Buffers>
        <Tensor arg-index="0" type="input" port-index="0" />   <!-- input (B, n, n) --> 
        <Tensor arg-index="1" type="output" port-index="0" format="BFYX"/> <!-- output (B,) --> 
    </Buffers>
    <CompilerOptions options="-cl-mad-enable -cl-fast-relaxed-math -cl-no-signed-zeros -cl-unsafe-math-optimizations"/>
    <WorkSizes global="B,1,1"/>
</CustomLayer> 


<CustomLayer name="CustomSVDu" type="SimpleGPU" version="1">
    <Kernel entry="ov_custom_svd_u">
        <Source filename="custom_svd_u.cl"/>
    </Kernel>
    <Buffers>
        <Tensor arg-index="0" type="input" port-index="0" format="BFYX"/>   <!-- input (B, M, N) --> 
        <Tensor arg-index="1" type="output" port-index="0"/> <!-- U (B, M, M) --> 
    </Buffers>
    <!-- <CompilerOptions options="-cl-mad-enable -cl-fast-relaxed-math -cl-no-signed-zeros"/> -->
    <CompilerOptions options="-cl-mad-enable"/>
    <WorkSizes global="B,1,1"/>
</CustomLayer>


<CustomLayer name="CustomSVDv" type="SimpleGPU" version="1">
    <Kernel entry="ov_custom_svd_v">
        <Source filename="custom_svd_v.cl"/>
    </Kernel>
    <Buffers>
        <Tensor arg-index="0" type="input" port-index="0" format="BFYX"/>   <!-- input (B, M, N) --> 
        <Tensor arg-index="1" type="output" port-index="0"/> <!-- V (B, N, N) --> 
    </Buffers>
    <!-- <CompilerOptions options="-cl-mad-enable -cl-fast-relaxed-math -cl-no-signed-zeros"/> -->
    <CompilerOptions options="-cl-mad-enable"/>
    <WorkSizes global="B,1,1"/>
</CustomLayer>


<CustomLayer name="FurthestPointSampling" type="SimpleGPU" version="1">
    <Kernel entry="ov_furthest_point_sampling">
        <Source filename="furthest_point_sampling.cl"/>
        <!-- <Source filename="furthest_point_sampling_optimized.cl"/> -->
        <!-- <Define name="npoint" type="int"   param="npoint"/> -->
    </Kernel>
    <Buffers>
        <Tensor arg-index="0" type="input" port-index="0" />   <!-- pts (B, N, 3) --> 
        <Tensor arg-index="1" type="input" port-index="1" />   <!-- npoint (npoint) --> 
        <Tensor arg-index="2" type="output" port-index="0" format="BFYX"/> <!-- output (B, npoint) -->  
    </Buffers>
    <CompilerOptions options="-cl-mad-enable -cl-fast-relaxed-math -cl-no-signed-zeros -cl-unsafe-math-optimizations"/>
    <WorkSizes global="B,1,1"/>
</CustomLayer> 


<CustomLayer name="GatherOperation" type="SimpleGPU" version="1">
    <Kernel entry="gather_operation">
        <Source filename="gather_operation.cl" />
    </Kernel>
    <Buffers>
        <Tensor arg-index="0" type="input" port-index="0" />
        <Tensor arg-index="1" type="input" port-index="1" />
        <Tensor arg-index="2" type="output" port-index="0" format="BFYX" />
    </Buffers>
    <CompilerOptions options="-cl-mad-enable -cl-fast-relaxed-math -cl-no-signed-zeros -cl-unsafe-math-optimizations" />
    <WorkSizes global="B*F*Y*X,1,1" /> 
</CustomLayer>


<CustomLayer name="GroupingOperation" type="SimpleGPU" version="1">
    <Kernel entry="grouping_operation">
        <Source filename="grouping_operation.cl" />
    </Kernel>
    <Buffers>
        <Tensor arg-index="0" type="input" port-index="0" />
        <Tensor arg-index="1" type="input" port-index="1" />
        <Tensor arg-index="2" type="output" port-index="0" format="BFYX" />
    </Buffers>
    <CompilerOptions options="-cl-mad-enable -cl-fast-relaxed-math -cl-no-signed-zeros -cl-unsafe-math-optimizations" />
    <WorkSizes global="B*F*Y*X,1,1" /> 
</CustomLayer>